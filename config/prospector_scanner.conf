# Prospector Scanner Configuration - Updated for split keyboard battery display

# Scanner Mode Configuration
CONFIG_PROSPECTOR_MODE_SCANNER=y

# Bluetooth Configuration
CONFIG_BT=y
CONFIG_BT_OBSERVER=y

# Display Configuration
CONFIG_ZMK_DISPLAY=y
CONFIG_DISPLAY=y

# LVGL Configuration
CONFIG_LVGL=y

# Enable LVGL widgets for settings screens
CONFIG_LV_USE_BTN=y
CONFIG_LV_USE_SLIDER=y
CONFIG_LV_USE_SWITCH=y

# Enable larger fonts for better readability
CONFIG_LV_FONT_MONTSERRAT_12=y
CONFIG_LV_FONT_MONTSERRAT_16=y  
CONFIG_LV_FONT_MONTSERRAT_18=y
CONFIG_LV_FONT_MONTSERRAT_20=y
CONFIG_LV_FONT_MONTSERRAT_22=y
CONFIG_LV_FONT_MONTSERRAT_24=y
CONFIG_LV_FONT_MONTSERRAT_28=y

# Enable Unscii pixel fonts for retro style
CONFIG_LV_FONT_UNSCII_8=y
CONFIG_LV_FONT_UNSCII_16=y

# Set default font to 20 (correct size for all widgets)
CONFIG_LV_FONT_DEFAULT_MONTSERRAT_20=y

# ‚ö° Prospector v1.1.1 Universal Brightness Control ‚ö°

# üåü BREAKTHROUGH: Universal Hardware Compatibility!
# 
# üîß v1.1.1 INNOVATION: Device Tree fallback system enables sensor mode by default
# - ‚úÖ SAFE FOR ALL USERS: Works with or without APDS9960 hardware
# - ‚úÖ AUTO-DETECTION: Runtime hardware detection with graceful fallback
# - ‚úÖ ZERO BOOT FAILURES: 100% startup success regardless of hardware
# - ‚úÖ SMOOTH OPERATION: 800ms fade transitions when sensor available
#
# üìã AUTOMATIC BEHAVIOR:
# - With APDS9960 connected: Automatic brightness with smooth fading
# - Without sensor hardware: Fixed brightness (85%) - no manual change needed
# - Sensor fails/disconnects: Automatic fallback to fixed brightness
# - No user action required: Firmware detects and adapts automatically
CONFIG_PROSPECTOR_MULTI_KEYBOARD=y
CONFIG_PROSPECTOR_MAX_KEYBOARDS=5

# Layer Display Configuration (v2.0.0+ with 0-9 support)
# Touch mode: Set to 10 to allow runtime adjustment via Display Settings
# Non-touch mode: Set to 7 for daily use (no runtime adjustment available)
# This sets the MAXIMUM possible layers (array size at compile time)
# The actual displayed count is controlled by the Max Layers slider in Display Settings (touch mode only)
CONFIG_PROSPECTOR_MAX_LAYERS=10

# üîÜ BRIGHTNESS SETTINGS (v1.1.1 Safe Implementation)
# Fixed brightness percentage when CONFIG=n or sensor not found
CONFIG_PROSPECTOR_FIXED_BRIGHTNESS=85

# üåü IDEAL USER EXPERIENCE: Single Configuration Option
# 
# ‚ú® AMBIENT LIGHT SENSOR (Automatic Dependencies)
# - y: Auto-brightness with sensor (requires APDS9960 hardware)
# - n: Fixed brightness mode (85%, universal compatibility) 
#
# When enabled (y): Automatically enables I2C, SENSOR, and APDS9960 drivers
# When disabled (n): Uses fixed brightness - no sensor hardware required
# 
# üìù To change: Simply set to 'y' or 'n' - all dependencies handled automatically!
CONFIG_PROSPECTOR_USE_AMBIENT_LIGHT_SENSOR=y

# üîß Advanced Settings (Optional customization)
CONFIG_PROSPECTOR_ALS_MIN_BRIGHTNESS=20
CONFIG_PROSPECTOR_ALS_MAX_BRIGHTNESS_USB=100

# üîÑ SMOOTH BRIGHTNESS FADE SETTINGS
CONFIG_PROSPECTOR_BRIGHTNESS_FADE_DURATION_MS=800
CONFIG_PROSPECTOR_BRIGHTNESS_FADE_STEPS=12

# ‚ö° Performance Settings

# Main loop timer interval (UI responsiveness vs battery life)
# Recommended values:
# - 100ms: Maximum responsiveness (CPU limit, may be unstable)
# - 120ms: Very responsive and stable (recommended for touch mode)
# - 150ms: Balanced responsiveness and efficiency
# - 200ms: Power-saving mode (may feel slightly laggy)
CONFIG_PROSPECTOR_SCANNER_MAIN_LOOP_INTERVAL_MS=120

# Scanner timeout - extended for battery operation (8 minutes)
# For testing, you can set a shorter timeout like 30000ms (30 seconds)
CONFIG_PROSPECTOR_SCANNER_TIMEOUT_MS=480000

# Battery operation power saving settings (require battery support enabled)
# Auto-dim display when keyboards go idle (2 minutes)
# CONFIG_PROSPECTOR_SCANNER_IDLE_BRIGHTNESS_MS=120000
# CONFIG_PROSPECTOR_SCANNER_IDLE_BRIGHTNESS_PERCENT=20

# Advertisement frequency-based dimming (requires battery support)
# CONFIG_PROSPECTOR_ADVERTISEMENT_FREQUENCY_DIM=y
# CONFIG_PROSPECTOR_ADV_FREQUENCY_DIM_THRESHOLD_MS=2000
# CONFIG_PROSPECTOR_ADV_FREQUENCY_DIM_BRIGHTNESS=25

# üí° v1.1.1 SENSOR MODE - Now Safe and Universal!
# ‚úÖ SENSOR MODE IS NOW THE DEFAULT and works safely on all hardware
# ‚úÖ No manual Device Tree configuration needed - auto-included
# ‚úÖ No boot failures - comprehensive Device Tree fallback system

# Disable unused features
CONFIG_ZMK_SPLIT=n

# USB Serial Logging (enabled via zmk-usb-logging snippet in build.yaml)
CONFIG_LOG=y
CONFIG_ZMK_LOG_LEVEL_DBG=y

# Reduce excessive debug noise (WARNING level for BT)
CONFIG_BT_LOG_LEVEL_WRN=y
CONFIG_LOG_DEFAULT_LEVEL=4

# YADS-style modifier detection and NerdFont display
# Build trigger: Compilation error fix (function forward declaration)
# Resolves battery periodic update work queue definition order
# Updated Wed Aug  7 2025

# WPM (Words Per Minute) Configuration Examples
# Uncomment and modify these lines to customize WPM calculation
# Default: 30-second window with 2x multiplier (balanced responsiveness)

# Ultra-responsive (10-second window, 6x multiplier):
# CONFIG_ZMK_STATUS_ADV_WPM_WINDOW_SECONDS=10

# Very responsive (15-second window, 4x multiplier):
# CONFIG_ZMK_STATUS_ADV_WPM_WINDOW_SECONDS=15

# Balanced (30-second window, 2x multiplier) - DEFAULT:
# CONFIG_ZMK_STATUS_ADV_WPM_WINDOW_SECONDS=30

# Stable (60-second window, 1x multiplier - traditional WPM):
# CONFIG_ZMK_STATUS_ADV_WPM_WINDOW_SECONDS=60

# Custom decay timeout (default: auto = 2x window, e.g., 60s for 30s window):
# CONFIG_ZMK_STATUS_ADV_WPM_DECAY_TIMEOUT_SECONDS=90

# Scanner Battery Support (v1.1.1 - Optional Feature)
# ‚ö†Ô∏è  DISABLED BY DEFAULT - Enable only if you have battery hardware
# For battery operation setup, see "Battery Operation Setup" section in README

# Battery support for scanner's own battery (top-right widget)
# Enable if you have a LiPo battery connected to XIAO BLE
CONFIG_PROSPECTOR_BATTERY_SUPPORT=y
CONFIG_ZMK_BATTERY_REPORTING=y
# CONFIG_USB_DEVICE_STACK=y
# CONFIG_PROSPECTOR_BATTERY_UPDATE_INTERVAL_S=120

# Additional battery options (when enabled):
# CONFIG_PROSPECTOR_BATTERY_SHOW_PERCENTAGE=y
# CONFIG_PROSPECTOR_BATTERY_WIDGET_POSITION="TOP_RIGHT"
# CONFIG_ZMK_BATTERY_REPORT_INTERVAL=30

# ‚ÑπÔ∏è  NOTE: Scanner works perfectly without battery hardware
# The battery widget will auto-hide if no battery is detected

# Debug Widget Configuration (v1.1 development)
# Debug widget disabled for production use - battery issue resolved
CONFIG_PROSPECTOR_DEBUG_WIDGET=n

# Note: Battery support is disabled by default since no battery hardware is currently connected.
# For UI testing: Enable DEMO_MODE. For real use: Add 400mAh LiPo battery hardware.

# Touch Panel Support - v2.0 Scanner Touch
# IMPORTANT: Touch support controlled by single CONFIG option
CONFIG_PROSPECTOR_TOUCH_ENABLED=y

# Increased stack sizes required for input processing pipeline
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_INPUT_THREAD_STACK_SIZE=4096

# Touch hardware drivers - AUTO-ENABLED by CONFIG_PROSPECTOR_TOUCH_ENABLED
# The following are automatically selected via Kconfig when touch enabled:
# - CONFIG_INPUT=y
# - CONFIG_INPUT_CST816S=y
# - CONFIG_INPUT_CST816S_INTERRUPT=y
# - CONFIG_ZMK_POINTING=y
# No need to set these manually!

